---
- hosts:
  - common_openshift
  gather_facts: no
  vars:
    ocp_vg: rhel
  tasks:
    - mount:
        path: "{{ item }}"
        state: absent
      loop:
        - /var/lib/etcd
        - /var/lib/origin
      tags:
        - unmount

    - name: remove ocp lvols
      lvol:
        vg: "{{ ocp_vg }}"
        lv: "{{ item }}"
        state: absent
      failed_when: false
      loop:
        - docker
        - etcd
        - origin
      tags:
        - rm-vol

    - command:
        argv:
          - partprobe
      tags:
        - refresh-block-devs

    - command:
        argv:
          - lsblk
          - /dev/{{ item }}
      loop:
        - sdc
        - sdd
      tags:
        - check-block-devs
