---
- name: vim et al is installed
  import_playbook: packages.yml

- name: puppet and prometheus exporters are disabled
  import_playbook: disable_puppet.yml

- name: haproxy is installed on loadbalancer nodes
  import_playbook: xx_haproxy_install.yml

- name: docker bridge ip is on non-default network
  import_playbook: docker_networking.yml

- name: nfs mount for rsyncing files from master
  hosts:
    - common-sys-dev1-master-1.ris.wustl.edu
  gather_facts: no
  tasks:
    - file:
        path: /mnt/ocp-nfs
        state: directory
    - mount:
        path: /mnt/ocp-nfs
        fstype: nfs
        src: storage-gluster-dev-node-1:/ocp-registry
        state: mounted
    - copy:
        dest: /mnt/ocp-nfs/xfer/.rsyncignore
        content: |
          .git*
          *.retry
          *.swp
          *.swo
          *.pyc
          .rsyncignore
    - shell: >
         rsync -av /usr/share/ansible/openshift-ansible/ /mnt/ocp-nfs/xfer/
         --exclude-from=/mnt/ocp-nfs/xfer/openshift-ansible/.gitignore
         --delete
      tags:
        - nfs-rsync
  tags:
    - nfs-mount

